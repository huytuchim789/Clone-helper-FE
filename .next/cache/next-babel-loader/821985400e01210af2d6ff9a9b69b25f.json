{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\TUYEN\\\\Documents\\\\ITSS\\\\Clone-helper-FE\\\\pages\\\\search.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport { publicFetch } from '../util/fetcher';\nimport Layout from '../components/layout';\nimport QuestionWrapper from '../components/question/question-wrapper';\nimport QuestionStats from '../components/question/question-stats';\nimport QuestionSummary from '../components/question/question-summary';\nimport PageTitle from '../components/page-title';\nimport ButtonGroup from '../components/button-group';\nimport NotFound from '../components/not-found-result';\nimport { Spinner } from '../components/icons';\nimport { Pagination } from \"antd\";\nconst SearchQuestion = () => {\n  const router = useRouter();\n  const {\n    0: questions,\n    1: setQuestions\n  } = useState(null);\n  const {\n    0: sortType,\n    1: setSortType\n  } = useState('Highest Vote');\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: total,\n    1: setTotal\n  } = useState(0);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  useEffect(() => {\n    const fetchQuestion = async () => {\n      setLoading(true);\n      try {\n        const res = await publicFetch.get(`/question?key=${router.query.key}&&page=${page}`);\n        const {\n          data,\n          total: totalQuestions\n        } = await res.data;\n        setQuestions(data);\n        setTotal(totalQuestions);\n        console.log('qq', questions);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n    const fetchQuestionByTag = async () => {\n      const {\n        data\n      } = await publicFetch.get(`/questions/${router.query.tag}`);\n      setQuestions(data);\n    };\n    if (router.query.tag) {\n      fetchQuestionByTag();\n    } else {\n      fetchQuestion();\n    }\n    setLoading(false);\n  }, [router.query.tag, page, router.query.key]);\n  const handelChange = page => {\n    setPage(page);\n  };\n  const handleSorting = () => {\n    switch (sortType) {\n      case 'Highest Vote':\n        return (a, b) => b.score - a.score;\n      case 'Highest View':\n        return (a, b) => b.views - a.views;\n      case 'Newest':\n        return (a, b) => new Date(b.created) - new Date(a.created);\n      case 'Oldest':\n        return (a, b) => new Date(a.created) - new Date(b.created);\n      default:\n        break;\n    }\n  };\n  return __jsx(Layout, {\n    extra: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 9\n    }\n  }, router.query.tag ? router.query.tag : 'Questions', \" - CodingHelper\")), __jsx(PageTitle, {\n    title: `Search result for [${router.query.key}]`,\n    button: true,\n    borderBottom: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }), __jsx(ButtonGroup, {\n    borderBottom: true,\n    buttons: ['Newest', 'Oldest', 'Highest Vote', 'Highest View'],\n    selected: sortType,\n    setPage: setPage,\n    setSelected: setSortType,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }\n  }), loading && __jsx(\"div\", {\n    className: \"loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, __jsx(Spinner, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  })), questions === null || questions === void 0 ? void 0 : questions.sort(handleSorting()).map(({\n    id,\n    votes,\n    answers,\n    views,\n    title,\n    text,\n    tags,\n    author,\n    created\n  }) => __jsx(QuestionWrapper, {\n    key: id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, __jsx(QuestionStats, {\n    voteCount: votes.length,\n    answerCount: answers.length,\n    view: views,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 15\n    }\n  }), __jsx(QuestionSummary, {\n    id: id,\n    title: title,\n    tags: tags,\n    author: author,\n    createdTime: created,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 15\n    }\n  }, text))), total != 0 ? __jsx(Pagination, {\n    pageSize: 10,\n    current: page,\n    total: total,\n    onChange: handelChange,\n    style: {\n      textAlign: \"center\",\n      margin: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 23\n    }\n  }) : __jsx(NotFound, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 14\n    }\n  }));\n};\nexport default SearchQuestion;","map":{"version":3,"names":["React","useState","useEffect","Head","useRouter","publicFetch","Layout","QuestionWrapper","QuestionStats","QuestionSummary","PageTitle","ButtonGroup","NotFound","Spinner","Pagination","SearchQuestion","router","questions","setQuestions","sortType","setSortType","page","setPage","total","setTotal","loading","setLoading","fetchQuestion","res","get","query","key","data","totalQuestions","console","log","error","fetchQuestionByTag","tag","handelChange","handleSorting","a","b","score","views","Date","created","sort","map","id","votes","answers","title","text","tags","author","length","textAlign","margin"],"sources":["C:/Users/TUYEN/Documents/ITSS/Clone-helper-FE/pages/search.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport Head from 'next/head'\r\nimport { useRouter } from 'next/router'\r\n\r\nimport { publicFetch } from '../util/fetcher'\r\n\r\nimport Layout from '../components/layout'\r\nimport QuestionWrapper from '../components/question/question-wrapper'\r\nimport QuestionStats from '../components/question/question-stats'\r\nimport QuestionSummary from '../components/question/question-summary'\r\nimport PageTitle from '../components/page-title'\r\nimport ButtonGroup from '../components/button-group'\r\nimport NotFound from '../components/not-found-result'\r\nimport { Spinner } from '../components/icons'\r\nimport { Pagination } from \"antd\";\r\n\r\nconst SearchQuestion = () => {\r\n\r\n  const router = useRouter()\r\n\r\n  const [questions, setQuestions] = useState(null)\r\n  const [sortType, setSortType] = useState('Highest Vote')\r\n  const [page, setPage] = useState(1)\r\n  const [total, setTotal] = useState(0)\r\n  const [loading, setLoading] = useState(false)\r\n\r\n\r\n  useEffect(() => {\r\n    const fetchQuestion = async () => {\r\n      setLoading(true)\r\n\r\n      try {\r\n        const res = await publicFetch.get(`/question?key=${router.query.key}&&page=${page}`)\r\n        const {data, total: totalQuestions} = await res.data\r\n        \r\n        setQuestions(data)\r\n        setTotal(totalQuestions)\r\n        console.log('qq', questions)\r\n      } catch (error){\r\n        console.log(error)\r\n      }\r\n\r\n    }\r\n\r\n    const fetchQuestionByTag = async () => {\r\n      const { data } = await publicFetch.get(`/questions/${router.query.tag}`)\r\n      setQuestions(data)\r\n    }\r\n\r\n    if (router.query.tag) {\r\n      fetchQuestionByTag()\r\n    } else {\r\n      fetchQuestion()\r\n    }\r\n    setLoading(false)\r\n\r\n  }, [router.query.tag, page, router.query.key])\r\n\r\n  const handelChange = (page) => {\r\n    setPage(page)\r\n  }\r\n\r\n  const handleSorting = () => {\r\n    switch (sortType) {\r\n      case 'Highest Vote':\r\n        return (a, b) => b.score - a.score\r\n      case 'Highest View':\r\n        return (a, b) => b.views - a.views\r\n      case 'Newest':\r\n        return (a, b) => new Date(b.created) - new Date(a.created)\r\n      case 'Oldest':\r\n        return (a, b) => new Date(a.created) - new Date(b.created)\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n\r\n  return (\r\n    <Layout extra={false}>\r\n      <Head>\r\n        <title>\r\n          {router.query.tag ? router.query.tag : 'Questions'} -\r\n          CodingHelper\r\n        </title>\r\n      </Head>\r\n\r\n      <PageTitle title={`Search result for [${router.query.key}]` } button borderBottom={false} />\r\n\r\n      <ButtonGroup\r\n        borderBottom\r\n        buttons={['Newest', 'Oldest', 'Highest Vote', 'Highest View', ]}\r\n        selected={sortType}\r\n        setPage={setPage}\r\n        setSelected={setSortType}\r\n      />\r\n\r\n      {loading && (\r\n        <div className=\"loading\">\r\n          <Spinner />\r\n        </div>\r\n      )}\r\n\r\n      {questions\r\n        ?.sort(handleSorting())\r\n        .map(\r\n          ({\r\n            id,\r\n            votes,\r\n            answers,\r\n            views,\r\n            title,\r\n            text,\r\n            tags,\r\n            author,\r\n            created\r\n          }) => (\r\n            <QuestionWrapper key={id}>\r\n              <QuestionStats\r\n                voteCount={votes.length}\r\n                answerCount={answers.length}\r\n                view={views}\r\n              />\r\n              <QuestionSummary\r\n                id={id}\r\n                title={title}\r\n                tags={tags}\r\n                author={author}\r\n                createdTime={created}\r\n              >\r\n                {text}\r\n              </QuestionSummary>\r\n            </QuestionWrapper>\r\n          )\r\n        )}\r\n        {/* <Pagination page={page} pages={pages} changePage={setPage} /> */}\r\n        {total != 0 ? <Pagination\r\n          pageSize={10}\r\n          current={page}\r\n          total={total}\r\n          onChange={handelChange}\r\n          style={{ textAlign: \"center\", margin: 20}}\r\n        /> : <NotFound />}\r\n    </Layout>\r\n  )\r\n}\r\n\r\nexport default SearchQuestion\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}